<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudentScope | Behavior Tracking</title>
    <style>
        /* === CORE STYLES (150 lines) === */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Arial, sans-serif; }
        body { background: #f8fafc; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        
        /* Header */
        header { text-align: center; margin-bottom: 30px; padding: 25px; 
                background: linear-gradient(135deg, #4a6fa5 0%, #2c3e50 100%); border-radius: 15px; color: white; }
        h1 { font-size: 2.8rem; margin-bottom: 10px; }
        
        /* 3-Column Grid */
        .three-columns { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px; }
        @media (max-width: 1024px) { .three-columns { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .three-columns { grid-template-columns: 1fr; } }
        
        /* Cards */
        .card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); }
        .card h2 { color: #2c3e50; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 3px solid; }
        .card-1 h2 { border-color: #27ae60; } .card-2 h2 { border-color: #9b59b6; } .card-3 h2 { border-color: #3498db; }
        
        /* Form Elements */
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50; }
        input, textarea, select { width: 100%; padding: 14px; border: 2px solid #e0e6ed; border-radius: 10px; font-size: 1rem; }
        textarea { min-height: 120px; resize: vertical; }
        
        /* Buttons */
        .save-button { width: 100%; padding: 16px; background: linear-gradient(135deg, #27ae60, #219653); 
                      color: white; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: 600; cursor: pointer; margin-top: 10px; }
        .ai-button { width: 100%; padding: 16px; background: linear-gradient(135deg, #9b59b6, #8e44ad); 
                    color: white; border: none; border-radius: 10px; font-size: 1.1rem; font-weight: 600; cursor: pointer; margin-top: 15px; }
        .docs-button { padding: 12px 24px; background: #4285f4; color: white; border: none; border-radius: 8px; 
                      font-size: 1rem; cursor: pointer; margin-left: auto; }
        
        /* Log Display */
        #logContainer { max-height: 400px; overflow-y: auto; margin-top: 20px; padding-top: 20px; }
        .log-entry { background: #f8fafc; padding: 20px; margin-bottom: 15px; border-left: 5px solid #4a6fa5; border-radius: 0 10px 10px 0; }
        .student-name { font-weight: bold; color: #2c3e50; font-size: 1.2rem; }
        .log-date { color: #7f8c8d; font-size: 0.9rem; margin-top: 5px; }
        .delete-btn { background: #e74c3c; color: white; border: none; padding: 8px 16px; border-radius: 6px; margin-top: 10px; cursor: pointer; }
        
        /* ABC Editor (Collapsible) */
        .abc-expandable { margin-top: 15px; max-height: 0; overflow: hidden; transition: max-height 0.4s; background: #f0f7ff; }
        .abc-expandable.expanded { max-height: 500px; padding: 20px; border: 1px solid #d0e0f0; }
        .edit-abc-btn { background: #3498db; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 0.85rem; cursor: pointer; margin-top: 10px; }
        .save-abc-btn { background: #27ae60; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 0.9rem; cursor: pointer; margin-top: 10px; width: 100%; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ StudentScope <span style="background:#ff6b6b;color:white;padding:4px 12px;border-radius:20px;font-size:0.8rem;">AI-POWERED</span></h1>
            <p style="font-size:1.2rem;opacity:0.9;">AI-assisted behavior tracking for modern educators</p>
        </header>
        
        <div class="three-columns">
            <!-- COLUMN 1: SIMPLE LOG FORM -->
            <div class="card card-1">
                <h2>üìù 1. Log Behavior</h2>
                <form id="behaviorForm">
                    <div class="form-group"><label>Student Name</label><input type="text" id="studentName" placeholder="Type student's name" required></div>
                    <input type="hidden" id="date">
                    <div class="form-group"><label>What happened?</label><textarea id="behavior" placeholder="Describe the behavior in detail..." required></textarea></div>
                    <button type="submit" class="save-button">üíæ SAVE BEHAVIOR</button>
                </form>
            </div>
            
            <!-- COLUMN 2: AI ASSISTANT -->
            <div class="card card-2">
                <h2>üß† 2. AI Assistant</h2>
                <p><em>Get AI suggestions for strategies and report wording</em></p>
                <div class="form-group"><label>Describe the situation</label><textarea id="aiPrompt" placeholder="E.g., 'Student becomes agitated during transitions...'"></textarea></div>
                <div class="form-group"><label>Focus area</label>
                    <select id="aiFocus">
                        <option value="strategies">Behavior Strategies</option>
                        <option value="report">Report Wording</option>
                        <option value="intervention">Intervention Ideas</option>
                        <option value="parent">Parent Communication</option>
                    </select>
                </div>
                <button id="aiButton" class="ai-button">ü§ñ GET AI SUGGESTIONS</button>
                <div id="aiOutput" style="margin-top:20px;padding:20px;background:#f8f5ff;border-radius:10px;min-height:200px;">
                    <div style="text-align:center;padding:40px 20px;color:#95a5a6;">
                        <div style="font-size:3rem;opacity:0.5;">ü§ñ</div>
                        <p>AI suggestions will appear here</p>
                        <p style="font-size:0.9rem;">Describe a situation above and click the button.</p>
                    </div>
                </div>
            </div>
            
            <!-- COLUMN 3: LOGS WITH ABC EDIT -->
            <div class="card card-3">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                    <h2 style="margin:0;">üìã 3. Behavior Logs</h2>
                    <button id="googleDocsBtn" class="docs-button">üìÑ Export to Docs</button>
                </div>
                <p><em>All logged behaviors appear here automatically</em></p>
                <div id="logContainer">
                    <div style="text-align:center;padding:40px 20px;color:#95a5a6;">
                        <div style="font-size:3rem;opacity:0.5;">üìã</div>
                        <p>No behaviors logged yet.</p>
                        <p style="font-size:0.9rem;">Save your first behavior in the left column.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <footer style="text-align:center;margin-top:40px;color:#7f8c8d;padding:20px;">
            <p>StudentScope LLC ‚Ä¢ <span style="color:#9b59b6;font-weight:600;">Powered by AI</span> ‚Ä¢ Data saves locally ‚Ä¢ Made for educators</p>
        </footer>
    </div>

    <script>
        // === CORE APP STATE ===
        const App = {
            logs: JSON.parse(localStorage.getItem('studentLogs')) || [],
            
            init() {
                this.setupEventListeners();
                this.loadLogs();
                console.log("StudentScope ready");
            },
            
            setupEventListeners() {
                document.getElementById('behaviorForm').addEventListener('submit', (e) => this.saveBehavior(e));
                document.getElementById('googleDocsBtn').addEventListener('click', () => this.exportToDocs());
                document.getElementById('aiButton').addEventListener('click', () => this.generateAISuggestions());
            },
            
            // === BEHAVIOR LOGGING ===
            saveBehavior(e)
            
                const behavior = {
                ...existingData,
                communicationStatus: {
                parentNotified: false, // Will be true when message sent
                messageId: null, // Links to TalkingParents-style message
                lastParentView: null
                 }
                };{
                e.preventDefault();
                
                const log = {
                    id: Date.now(),
                    studentName: document.getElementById('studentName').value.trim(),
                    date: new Date().toISOString(),
                    behavior: document.getElementById('behavior').value.trim(),
                    antecedent: "",
                    consequence: "",
                    comments: []
                };
                
                if (!log.studentName || !log.behavior) {
                    alert("Please enter both student name and behavior description");
                    return;
                }
                
                this.logs.push(log);
                localStorage.setItem('studentLogs', JSON.stringify(this.logs));
                this.displayLog(log);
                
                document.getElementById('studentName').value = '';
                document.getElementById('behavior').value = '';
                document.getElementById('studentName').focus();
            },
            
            // === LOG DISPLAY WITH ABC EDIT ===
            displayLog(log) {
                const container = document.getElementById('logContainer');
                const emptyState = container.querySelector('.empty-state');
                if (emptyState) container.removeChild(emptyState);
                
                const entry = document.createElement('div');
                entry.className = 'log-entry';
                entry.dataset.id = log.id;
                
                const date = new Date(log.date).toLocaleDateString('en-US', {
                    month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit'
                });
                
                const hasABC = log.antecedent || log.consequence;
                const hasComments = log.comments?.length > 0;
                
                entry.innerHTML = `
                    <div class="student-name">${log.studentName}</div>
                    <div class="log-date">${date}</div>
                    <div style="margin-top:15px;line-height:1.5;"><strong>Behavior:</strong> ${log.behavior}</div>
                    ${log.antecedent ? `<div style="margin-top:8px;"><strong>Antecedent:</strong> ${log.antecedent}</div>` : ''}
                    ${log.consequence ? `<div style="margin-top:8px;"><strong>Consequence:</strong> ${log.consequence}</div>` : ''}
                    ${hasComments ? `<div style="margin-top:15px;"><strong>Comments:</strong> ${log.comments.length}</div>` : ''}
                    
                    <button class="edit-abc-btn" onclick="App.toggleABCEditor(${log.id})">
                        ${hasABC || hasComments ? '‚úèÔ∏è Edit' : '‚ûï Add ABC/Comment'}
                    </button>
                    
                    <div class="abc-expandable" id="abcEditor-${log.id}">
                        <div style="margin-bottom:15px;">
                            <label style="color:#2c3e50;font-size:0.9rem;font-weight:600;">Antecedent (What happened BEFORE?)</label>
                            <textarea id="antecedent-${log.id}" style="width:100%;min-height:60px;padding:10px;">${log.antecedent || ''}</textarea>
                        </div>
                        <div style="margin-bottom:15px;">
                            <label style="color:#2c3e50;font-size:0.9rem;font-weight:600;">Consequence (What happened AFTER?)</label>
                            <textarea id="consequence-${log.id}" style="width:100%;min-height:60px;padding:10px;">${log.consequence || ''}</textarea>
                        </div>
                        <div style="border-top:1px dashed #c8d6e5;padding-top:15px;">
                            <label style="color:#2c3e50;font-size:0.9rem;font-weight:600;">Add a Comment</label>
                            <textarea id="newComment-${log.id}" style="width:100%;min-height:60px;padding:10px;" placeholder="Optional notes..."></textarea>
                            <button onclick="App.addComment(${log.id})" class="save-abc-btn">üí¨ Add Comment</button>
                        </div>
                        <button onclick="App.saveABCData(${log.id})" class="save-abc-btn">üíæ Save ABC Data</button>
                    </div>
                    
                    <button onclick="App.deleteLog(${log.id})" class="delete-btn">üóëÔ∏è Delete</button>
                `;
                
                container.prepend(entry);
            },
            
            // === ABC EDITOR FUNCTIONS ===
            toggleABCEditor(logId) {
                const editor = document.getElementById(`abcEditor-${logId}`);
                const button = event.target;
                
                if (editor.classList.contains('expanded')) {
                    editor.classList.remove('expanded');
                    button.textContent = button.textContent.includes('Edit') ? '‚úèÔ∏è Edit' : '‚ûï Add ABC/Comment';
                } else {
                    document.querySelectorAll('.abc-expandable.expanded').forEach(el => el.classList.remove('expanded'));
                    editor.classList.add('expanded');
                    button.textContent = '‚ñ≤ Close';
                }
            },
            
            saveABCData(logId) {
                const logIndex = this.logs.findIndex(log => log.id === logId);
                if (logIndex === -1) return;
                
                this.logs[logIndex].antecedent = document.getElementById(`antecedent-${logId}`).value.trim();
                this.logs[logIndex].consequence = document.getElementById(`consequence-${logId}`).value.trim();
                
                localStorage.setItem('studentLogs', JSON.stringify(this.logs));
                document.getElementById(`abcEditor-${logId}`).classList.remove('expanded');
                this.refreshLogDisplay(logId);
            },
            
            addComment(logId) {
                const commentText = document.getElementById(`newComment-${logId}`).value.trim();
                if (!commentText) return alert("Please enter a comment");
                
                const logIndex = this.logs.findIndex(log => log.id === logId);
                if (logIndex === -1) return;
                
                if (!this.logs[logIndex].comments) this.logs[logIndex].comments = [];
                
                this.logs[logIndex].comments.push({
                    text: commentText,
                    timestamp: new Date().toISOString(),
                    author: "Staff"
                });
                
                localStorage.setItem('studentLogs', JSON.stringify(this.logs));
                document.getElementById(`newComment-${logId}`).value = '';
                this.refreshLogDisplay(logId);
            },
            
            refreshLogDisplay(logId) {
                const log = this.logs.find(log => log.id === logId);
                if (!log) return;
                
                const oldEntry = document.querySelector(`[data-id="${logId}"]`);
                if (oldEntry) oldEntry.remove();
                
                this.displayLog(log);
            },
            
            deleteLog(id) {
                if (!confirm('Delete this behavior log?')) return;
                
                this.logs = this.logs.filter(log => log.id !== id);
                localStorage.setItem('studentLogs', JSON.stringify(this.logs));
                
                const entry = document.querySelector(`[data-id="${id}"]`);
                if (entry) entry.remove();
                
                if (this.logs.length === 0) {
                    document.getElementById('logContainer').innerHTML = `
                        <div style="text-align:center;padding:40px 20px;color:#95a5a6;">
                            <div style="font-size:3rem;opacity:0.5;">üìã</div>
                            <p>No behaviors logged yet.</p>
                            <p style="font-size:0.9rem;">Save your first behavior in the left column.</p>
                        </div>
                    `;
                }
            },
            
            loadLogs() {
                if (this.logs.length === 0) return;
                document.getElementById('logContainer').innerHTML = '';
                this.logs.slice().reverse().forEach(log => this.displayLog(log));
            },
            
            // === AI ASSISTANT (Simulated) ===
            generateAISuggestions() {
                const prompt = document.getElementById('aiPrompt').value.trim();
                const focus = document.getElementById('aiFocus').value;
                const output = document.getElementById('aiOutput');
                
                if (!prompt) return alert("Please describe a situation");
                
                output.innerHTML = `<div style="text-align:center;padding:30px;color:#7f8c8d;">ü§î AI is thinking...</div>`;
                
                setTimeout(() => {
                    const suggestions = this.getAISuggestions(prompt, focus);
                    output.innerHTML = `
                        <h3 style="color:#2c3e50;margin-bottom:20px;">ü§ñ AI Suggestions</h3>
                        ${suggestions.map((s, i) => `
                            <div style="background:white;padding:15px;margin-bottom:10px;border-radius:8px;border-left:4px solid #9b59b6;">
                                <h4 style="color:#2c3e50;margin-bottom:8px;">Suggestion ${i+1}</h4>
                                <p>${s}</p>
                            </div>
                        `).join('')}
                    `;
                }, 1000);
            },
            
            getAISuggestions(prompt, focus) {
                const strategies = [
                    "Implement visual schedule with transition warnings.",
                    "Use 'break card' system for sensory breaks.",
                    "Try token economy with immediate reinforcement.",
                    "Provide alternative seating options."
                ];
                return strategies.slice(0, 3);
            },
            
            // === EXPORT ===
            exportToDocs() {
                if (this.logs.length === 0) return alert('No behaviors to export');
                
                let content = `STUDENTSCOPE REPORT\n${new Date().toLocaleDateString()}\n\n`;
                this.logs.forEach(log => {
                    content += `${log.studentName} - ${new Date(log.date).toLocaleDateString()}\n`;
                    content += `Behavior: ${log.behavior}\n`;
                    if (log.antecedent) content += `Antecedent: ${log.antecedent}\n`;
                    if (log.consequence) content += `Consequence: ${log.consequence}\n\n`;
                });
                
                const blob = new Blob([content], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `StudentScope_Report_${new Date().toISOString().slice(0,10)}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                alert(`Report exported with ${this.logs.length} behaviors`);
            }
        };
        
        // Start the app
        document.addEventListener('DOMContentLoaded', () => App.init());
    </script>
</body>
</html>
