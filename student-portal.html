brianjamesomalley
StudentscopeCOMPREHENSIVE
Repository navigation
Code
Issues
Pull requests
Actions
Projects
1
 (1)
Wiki
Security
3
 (3)
Insights
Settings
Commit a2d0b26
brianjamesomalley
brianjamesomalley
authored
2 days ago
¬∑
¬∑
Verified
Update student-portal
main
1 parent 
c72b3a7
 commit 
a2d0b26
File tree
Filter files‚Ä¶
student-portal
1 file changed
+208
-373
lines changed
Search within code
 
‚Äéstudent-portal‚Äé
+208
-373
Lines changed: 208 additions & 373 deletions
Original file line number	Diff line number	Diff line change
@@ -3,34 +3,42 @@
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StudentScope Arcade</title>
<title>StudentScope Arcade - Atari Edition</title>
<style>
:root {
  --primary: #F59E0B;
  --primary-dark: #D97706;
  --secondary: #10B981;
  --accent: #8B5CF6;
  --danger: #EF4444;
  --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --bg-gradient: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  font-family: 'Courier New', monospace;
  background: var(--bg-gradient);
  min-height: 100vh;
  color: #1F2937;
  color: #fff;
}

/* LOGIN SCREEN */
.auth-container {
  max-width: 400px;
  margin: 10vh auto;
  background: white;
  margin: 20vh auto;
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  padding: 40px;
  border-radius: 20px;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  border: 2px solid var(--primary);
  text-align: center;
}
.auth-container h1 {
  color: var(--primary);
  font-size: 2.5rem;
  margin-bottom: 10px;
  text-shadow: 0 0 10px var(--primary);
}

.student-code-input {
@@ -39,195 +47,121 @@ body {
  font-size: 32px;
  text-align: center;
  letter-spacing: 8px;
  background: rgba(255,255,255,0.1);
  border: 3px solid var(--primary);
  border-radius: 12px;
  color: white;
  margin: 20px 0;
  text-transform: uppercase;
  font-family: monospace;
}
.play-btn {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  border: none;
  padding: 15px 30px;
  border-radius: 10px;
  font-weight: bold;
  font-size: 1.2rem;
  cursor: pointer;
  width: 100%;
  font-family: 'Courier New', monospace;
}
.play-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* MAIN PORTAL */
.portal {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 0 1rem;
  padding: 1rem;
  display: none;
}
.portal.active {
  display: block;
}

/* HEADER WITH POINTS */
/* HEADER */
.header {
  background: white;
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 20px 30px;
  margin-bottom: 30px;
  padding: 20px;
  margin-bottom: 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  border: 2px solid var(--primary);
}

.student-info h1 {
  font-size: 2rem;
  color: var(--primary-dark);
  color: var(--primary);
}

.points-display {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  background: var(--primary);
  padding: 15px 30px;
  border-radius: 50px;
  text-align: center;
  box-shadow: 0 0 20px var(--primary);
}

.points-number {
  font-size: 2.5rem;
  font-weight: 800;
  font-size: 3rem;
  font-weight: bold;
  line-height: 1;
}

.points-label {
  font-size: 0.9rem;
  opacity: 0.9;
}
/* PROGRESS SECTION */
.progress-section {
  background: white;
  border-radius: 20px;
  padding: 25px;
  margin-bottom: 30px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}
.progress-bars {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  margin-top: 20px;
}
.progress-item {
  text-align: center;
}
.progress-circle {
  width: 120px;
  height: 120px;
  margin: 0 auto 15px;
  position: relative;
}
.circle-bg {
  fill: none;
  stroke: #e0e0e0;
  stroke-width: 8;
}
.circle-progress {
  fill: none;
  stroke: var(--primary);
  stroke-width: 8;
  stroke-linecap: round;
  transform: rotate(-90deg);
  transform-origin: 50% 50%;
  transition: stroke-dasharray 0.3s;
}
.progress-stats {
  display: flex;
  justify-content: center;
  gap: 20px;
  margin-top: 15px;
}
.stat {
  text-align: center;
}
.stat-value {
  font-size: 1.8rem;
  font-weight: 700;
  color: var(--primary);
}
.stat-label {
  font-size: 0.85rem;
  color: #6B7280;
}
/* GAMES GRID */
.games-section {
  background: white;
  border-radius: 20px;
  padding: 25px;
  margin-bottom: 30px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}
.games-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
  margin: 20px 0;
}

.game-card {
  background: linear-gradient(135deg, #f6f9fc 0%, #e9f2f9 100%);
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 20px;
  text-align: center;
  transition: transform 0.2s, box-shadow 0.2s;
  position: relative;
  overflow: hidden;
  border: 2px solid var(--primary);
  transition: all 0.3s;
  cursor: pointer;
}

.game-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(0,0,0,0.15);
}
.game-card.locked {
  opacity: 0.7;
  filter: grayscale(0.5);
  pointer-events: none;
  box-shadow: 0 0 30px var(--primary);
}

.game-icon {
  font-size: 4rem;
  margin-bottom: 15px;
  text-align: center;
  margin-bottom: 10px;
}

.game-title {
  font-size: 1.5rem;
  font-weight: 700;
  font-weight: bold;
  text-align: center;
  margin-bottom: 10px;
  color: #2C3E50;
  color: var(--primary);
}

.game-cost {
  background: var(--primary);
  color: white;
  padding: 8px 15px;
  border-radius: 25px;
  background: var(--primary-dark);
  padding: 5px 10px;
  border-radius: 20px;
  display: inline-block;
  margin: 15px 0;
  font-weight: 700;
}
.play-btn {
  background: linear-gradient(135deg, var(--secondary), #0EA5E9);
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 25px;
  font-weight: 700;
  cursor: pointer;
  margin: 10px auto;
  text-align: center;
  width: 100%;
  font-size: 1.1rem;
}
.play-btn:disabled {
  background: #CBD5E0;
  cursor: not-allowed;
}

/* GAME MODAL */
@@ -238,7 +172,7 @@ body {
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.9);
  background: rgba(0,0,0,0.95);
  z-index: 1000;
  justify-content: center;
  align-items: center;
@@ -249,19 +183,19 @@ body {
}

.game-frame {
  background: #1a1a2e;
  background: #000;
  padding: 20px;
  border-radius: 15px;
  max-width: 800px;
  max-width: 900px;
  width: 90%;
  max-height: 80vh;
  position: relative;
  border: 3px solid var(--primary);
}

.close-game {
  position: absolute;
  top: -10px;
  right: -10px;
  top: -15px;
  right: -15px;
  background: var(--danger);
  color: white;
  border: none;
@@ -274,152 +208,80 @@ body {
}

.game-timer {
  background: white;
  background: var(--primary);
  padding: 10px;
  border-radius: 5px;
  margin-bottom: 10px;
  text-align: center;
  font-size: 1.2rem;
  font-weight: 700;
  font-weight: bold;
}
.game-frame iframe {
  width: 100%;
  height: 500px;
  border: none;
}

/* BEHAVIOR FEED */
/* PROGRESS */
.recent-behaviors {
  background: white;
  border-radius: 20px;
  padding: 25px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 20px;
  margin-top: 20px;
  border: 2px solid var(--primary);
}

.behavior-item {
  padding: 10px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 12px;
  border-bottom: 1px solid #E5E7EB;
  justify-content: space-between;
}

.behavior-item:last-child {
  border-bottom: none;
}

.behavior-icon {
  font-size: 1.5rem;
}
.behavior-positive {
  color: var(--secondary);
}
.behavior-negative {
  color: var(--danger);
}
.positive { color: var(--secondary); }
.negative { color: var(--danger); }

/* UTILITIES */
.hidden { display: none; }
.loading { text-align: center; padding: 40px; }
</style>
</head>
<body>

<!-- AUTH SCREEN -->
<!-- LOGIN SCREEN -->
<div id="authScreen" class="auth-container">
  <h1 style="text-align:center; color: var(--primary); margin-bottom: 10px;">üéÆ StudentScope Arcade</h1>
  <p style="text-align:center; color: #6B7280; margin-bottom: 30px;">Enter your access code to play</p>
  
  <h1>üéÆ ATARI ARCADE</h1>
  <p>Enter your access code</p>
  <input type="text" id="accessCode" class="student-code-input" maxlength="6" placeholder="ABC123">
  <button id="loginBtn" class="play-btn" style="margin-top: 20px;">ENTER ARCADE</button>
  
  <div id="loginError" style="color: var(--danger); text-align: center; margin-top: 15px; display: none;"></div>
  <button id="loginBtn" class="play-btn">ENTER ARCADE</button>
  <div id="loginError" style="color: var(--danger); margin-top: 15px; display: none;"></div>
</div>

<!-- MAIN PORTAL -->
<div id="portal" class="portal hidden">
  <!-- Header -->
<div id="portal" class="portal">
  <div class="header">
    <div class="student-info">
      <h1 id="studentName">Loading...</h1>
      <p id="grade" style="color: #6B7280;"></p>
      <p id="grade"></p>
    </div>
    <div class="points-display">
      <div class="points-number" id="points">0</div>
      <div class="points-label">Behavior Bucks</div>
    </div>
    <button id="logoutBtn" style="background: none; border: 2px solid #CBD5E0; padding: 8px 16px; border-radius: 8px; cursor: pointer;">üö™ Exit</button>
  </div>
  <!-- Progress Section -->
  <div class="progress-section">
    <h2>üìä Your Progress This Week</h2>
    <div class="progress-bars">
      <div class="progress-item">
        <h3>Positive Behaviors</h3>
        <div class="progress-circle">
          <svg width="120" height="120">
            <circle class="circle-bg" cx="60" cy="60" r="50"></circle>
            <circle class="circle-progress" id="positiveProgress" cx="60" cy="60" r="50" style="stroke-dasharray: 0, 314;"></circle>
          </svg>
        </div>
        <div class="stat-value" id="positiveCount">0</div>
      </div>
      <div class="progress-item">
        <h3>Total Points</h3>
        <div class="progress-circle">
          <svg width="120" height="120">
            <circle class="circle-bg" cx="60" cy="60" r="50"></circle>
            <circle class="circle-progress" id="pointsProgress" cx="60" cy="60" r="50" style="stroke-dasharray: 0, 314;"></circle>
          </svg>
        </div>
        <div class="stat-value" id="pointsEarned">0</div>
      </div>
      <div>BEHAVIOR BUCKS</div>
    </div>
    <button id="logoutBtn" style="background: none; border: 2px solid var(--primary); color: white; padding: 10px 20px; border-radius: 10px; cursor: pointer;">EXIT</button>
  </div>

  <!-- Games Section -->
  <div class="games-section">
    <h2>üéÆ Arcade Rewards</h2>
    <div class="games-grid" id="gamesGrid">
      <!-- Tetris -->
      <div class="game-card" id="gameTetris">
        <div class="game-icon">üß©</div>
        <div class="game-title">TETRIS</div>
        <div class="game-cost">50 points</div>
        <p style="color: #6B7280; margin-bottom: 15px;">Classic block stacking fun!</p>
        <button class="play-btn" onclick="Arcade.playGame('tetris', 50)">PLAY - 5 MINUTES</button>
      </div>
      <!-- Typing Game -->
      <div class="game-card" id="gameTyping">
        <div class="game-icon">‚å®Ô∏è</div>
        <div class="game-title">TYPING CHALLENGE</div>
        <div class="game-cost">30 points</div>
        <p style="color: #6B7280; margin-bottom: 15px;">Improve your typing speed!</p>
        <button class="play-btn" onclick="Arcade.playGame('typing', 30)">PLAY - 5 MINUTES</button>
      </div>
  <!-- GAMES GRID -->
  <h2 style="margin: 20px 0;">üéÆ SELECT GAME</h2>
  <div class="games-grid" id="gamesGrid"></div>

      <!-- Pac-Man -->
      <div class="game-card" id="gamePacman">
        <div class="game-icon">üëæ</div>
        <div class="game-title">PAC-MAN</div>
        <div class="game-cost">75 points</div>
        <p style="color: #6B7280; margin-bottom: 15px;">Waka waka waka!</p>
        <button class="play-btn" onclick="Arcade.playGame('pacman', 75)">PLAY - 5 MINUTES</button>
      </div>
      <!-- Memory Game -->
      <div class="game-card" id="gameMemory">
        <div class="game-icon">üß†</div>
        <div class="game-title">MEMORY MATCH</div>
        <div class="game-cost">40 points</div>
        <p style="color: #6B7280; margin-bottom: 15px;">Test your memory!</p>
        <button class="play-btn" onclick="Arcade.playGame('memory', 40)">PLAY - 5 MINUTES</button>
      </div>
    </div>
  </div>
  <!-- Recent Behavior Feed -->
  <!-- RECENT BEHAVIORS -->
  <div class="recent-behaviors">
    <h2>üìã Recent Recognition</h2>
    <h2>üìã RECENT RECOGNITION</h2>
    <div id="behaviorFeed"></div>
  </div>
</div>
@@ -428,8 +290,8 @@ body {
<div id="gameModal" class="game-modal">
  <div class="game-frame">
    <button class="close-game" onclick="Arcade.closeGame()">‚úï</button>
    <div class="game-timer" id="gameTimer">Time remaining: 5:00</div>
    <iframe id="gameFrame" style="width: 100%; height: 500px; border: none; background: white;"></iframe>
    <div class="game-timer" id="gameTimer">Time: 5:00</div>
    <iframe id="gameFrame" allowfullscreen></iframe>
  </div>
</div>

@@ -438,7 +300,7 @@ body {
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
// Firebase Config
// ========== FIREBASE CONFIG ==========
const firebaseConfig = {
  apiKey: "AIzaSyDFI44iKYUJNu9-67UkfHQHeKHBRAjKleA",
  authDomain: "studentscopebehaviorcenter.firebaseapp.com",
@@ -449,218 +311,191 @@ const firebaseConfig = {
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// Student Arcade
// ========== ATARI GAMES ==========
const GAMES = [
  { name: "SPACE INVADERS", icon: "üëæ", cost: 50, url: "https://archive.org/embed/space_invaders_atari_2600" },
  { name: "ASTEROIDS", icon: "‚òÑÔ∏è", cost: 60, url: "https://archive.org/embed/a26_asteroids_1981_atari_pal" },
  { name: "MISSILE COMMAND", icon: "üöÄ", cost: 55, url: "https://archive.org/embed/a26_missile_command_1981_atari" },
  { name: "ADVENTURE", icon: "üè∞", cost: 45, url: "https://archive.org/embed/a26_adventure_1980_atari" },
  { name: "COMBAT", icon: "üí•", cost: 40, url: "https://archive.org/embed/a26_combat_1977_atari" },
  { name: "YARS' REVENGE", icon: "ü¶ã", cost: 65, url: "https://archive.org/embed/a26_yars_revenge_1982_atari" },
  { name: "PITFALL", icon: "üå¥", cost: 70, url: "https://archive.org/embed/a26_pitfall_1982_activision" },
  { name: "RIVER RAID", icon: "üåä", cost: 65, url: "https://archive.org/embed/a26_river_raid_1982_activision" },
  { name: "FROGGER", icon: "üê∏", cost: 55, url: "https://archive.org/embed/a26_frogger_1982_parker_brothers" },
  { name: "DONKEY KONG", icon: "ü¶ç", cost: 80, url: "https://archive.org/embed/a26_donkey_kong_1982_coleco" },
  { name: "CENTIPEDE", icon: "üêõ", cost: 60, url: "https://archive.org/embed/a26_centipede_1983_atari" },
  { name: "DEFENDER", icon: "üõ∏", cost: 70, url: "https://archive.org/embed/a26_defender_1982_atari" },
  { name: "BERZERK", icon: "ü§ñ", cost: 50, url: "https://archive.org/embed/a26_berzerk_1982_atari" },
  { name: "DEMON ATTACK", icon: "üëπ", cost: 55, url: "https://archive.org/embed/a26_demon_attack_1982_imagic" },
  { name: "MEGAMANIA", icon: "üí´", cost: 60, url: "https://archive.org/embed/a26_megamania_1982_activision" },
  { name: "PAC-MAN", icon: "üëª", cost: 75, url: "https://archive.org/embed/a26_pac-man_1982_atari" },
  { name: "E.T.", icon: "üìû", cost: 85, url: "https://archive.org/embed/a26_e.t._the_extra-terrestrial_1982_atari" },
  { name: "FROSTBITE", icon: "‚ùÑÔ∏è", cost: 50, url: "https://archive.org/embed/a26_frostbite_1983_activision" },
  { name: "H.E.R.O.", icon: "‚õëÔ∏è", cost: 65, url: "https://archive.org/embed/a26_hero_1984_activision" },
  { name: "KABOOM", icon: "üí£", cost: 45, url: "https://archive.org/embed/a26_kaboom_1981_activision" }
];
// ========== ARCADE ==========
const Arcade = {
  currentStudent: null,
  currentPoints: 0,
  gameTimer: null,
  gameTimeLeft: 300, // 5 minutes in seconds
  
  gameTimeLeft: 300,
  init() {
    document.getElementById('loginBtn').addEventListener('click', () => this.login());
    document.getElementById('accessCode').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') this.login();
    });
    document.getElementById('logoutBtn').addEventListener('click', () => this.logout());
    this.renderGames();
  },
  
  renderGames() {
    const grid = document.getElementById('gamesGrid');
    grid.innerHTML = GAMES.map(game => `
      <div class="game-card" onclick="Arcade.playGame('${game.url}', ${game.cost})">
        <div class="game-icon">${game.icon}</div>
        <div class="game-title">${game.name}</div>
        <div class="game-cost">${game.cost} POINTS</div>
      </div>
    `).join('');
  },
  async login() {
    const code = document.getElementById('accessCode').value.trim().toUpperCase();

    if (!code || code.length !== 6) {
      this.showError('Please enter a valid 6-character code');
      this.showError('Enter a valid 6-character code');
      return;
    }
    
    try {
      // Find student by access code
      const studentSnapshot = await db.collection('students')
        .where('accessCode', '==', code)
        .get();
      
      if (studentSnapshot.empty) {
        this.showError('Invalid access code');
        this.showError('Invalid code');
        return;
      }
      
      const studentDoc = studentSnapshot.docs[0];
      this.currentStudent = { id: studentDoc.id, ...studentDoc.data() };

      // Initialize points if not exists
      if (!this.currentStudent.points) {
        await studentDoc.ref.update({ points: 0 });
        this.currentStudent.points = 0;
      }

      this.currentPoints = this.currentStudent.points;

      // Show portal
      document.getElementById('authScreen').classList.add('hidden');
      document.getElementById('portal').classList.remove('hidden');
      document.getElementById('authScreen').style.display = 'none';
      document.getElementById('portal').classList.add('active');

      this.updateUI();
      this.loadBehaviors();

    } catch (error) {
      console.error('Login error:', error);
      this.showError('Failed to login. Please try again.');
      this.showError('Login failed');
    }
  },
  
  logout() {
    this.currentStudent = null;
    document.getElementById('authScreen').classList.remove('hidden');
    document.getElementById('portal').classList.add('hidden');
    document.getElementById('authScreen').style.display = 'block';
    document.getElementById('portal').classList.remove('active');
    document.getElementById('accessCode').value = '';
  },
  
  showError(message) {
    const errorDiv = document.getElementById('loginError');
    errorDiv.textContent = message;
    errorDiv.style.display = 'block';
    setTimeout(() => errorDiv.style.display = 'none', 3000);
  },
  
  async updateUI() {
  updateUI() {
    document.getElementById('studentName').textContent = this.currentStudent.name;
    document.getElementById('grade').textContent = `Grade ${this.currentStudent.grade || 'N/A'}`;
    document.getElementById('points').textContent = this.currentPoints;
    
    // Update game card states based on points
    const gameCards = document.querySelectorAll('.game-card');
    gameCards.forEach(card => {
      const cost = parseInt(card.querySelector('.game-cost').textContent);
      const btn = card.querySelector('.play-btn');
      if (this.currentPoints < cost) {
        btn.disabled = true;
        btn.textContent = `Need ${cost} points`;
      } else {
        btn.disabled = false;
        btn.textContent = 'PLAY - 5 MINUTES';
      }
    });
  },
  
  async loadBehaviors() {
    const snapshot = await db.collection('behaviors')
      .where('studentId', '==', this.currentStudent.id)
      .orderBy('timestamp', 'desc')
      .limit(10)
      .get();
    
    const feed = document.getElementById('behaviorFeed');
    feed.innerHTML = '';
    
    if (snapshot.empty) {
      feed.innerHTML = '<p style="text-align: center; color: #6B7280;">No behaviors logged yet. Be your best self!</p>';
      return;
    }
    
    let positiveCount = 0;
    let pointsEarned = 0;
    
    snapshot.forEach(doc => {
      const behavior = doc.data();
      const date = new Date(behavior.timestamp).toLocaleDateString();
      const points = behavior.type === 'positive' ? 10 : -5;
      
      if (behavior.type === 'positive') {
        positiveCount++;
        pointsEarned += points;
      }
      
      const item = document.createElement('div');
      item.className = 'behavior-item';
      item.innerHTML = `
        <div class="behavior-icon ${behavior.type === 'positive' ? 'behavior-positive' : 'behavior-negative'}">
          ${behavior.type === 'positive' ? '‚≠ê' : 'üìù'}
        </div>
        <div style="flex: 1;">
          <div style="font-weight: 600;">${behavior.behavior}</div>
          <div style="color: #6B7280; font-size: 0.9rem;">${date}</div>
        </div>
        <div style="font-weight: 700; color: ${behavior.type === 'positive' ? '#10B981' : '#EF4444'}">
          ${behavior.type === 'positive' ? '+' : ''}${points}
        </div>
      `;
      feed.appendChild(item);
    });
    
    // Update progress stats
    document.getElementById('positiveCount').textContent = positiveCount;
    document.getElementById('pointsEarned').textContent = pointsEarned;
    
    // Update progress circles
    const positiveProgress = (positiveCount / 20) * 314; // Max 20 positives
    document.getElementById('positiveProgress').style.strokeDasharray = `${positiveProgress}, 314`;
    
    const pointsProgress = (this.currentPoints / 200) * 314; // Max 200 points
    document.getElementById('pointsProgress').style.strokeDasharray = `${pointsProgress}, 314`;
  },
  
  async playGame(game, cost) {
  async playGame(url, cost) {
    if (this.currentPoints < cost) {
      alert(`You need ${cost} points to play!`);
      alert(`Need ${cost} points! Earn more by being awesome!`);
      return;
    }
    
    // Deduct points
    const newPoints = this.currentPoints - cost;
    await db.collection('students').doc(this.currentStudent.id).update({
      points: newPoints
    });
    this.currentPoints = newPoints;
    this.updateUI();
    
    // Open game
    document.getElementById('gameModal').classList.add('active');
    const gameFrame = document.getElementById('gameFrame');
    
    // Load game based on selection
    switch(game) {
      case 'tetris':
        gameFrame.src = 'https://tetris.com/play-tetris';
        break;
      case 'typing':
        gameFrame.src = 'https://www.typing.com/student/games';
        break;
      case 'pacman':
        gameFrame.src = 'https://www.google.com/logos/2010/pacman10-i.html';
        break;
      case 'memory':
        gameFrame.src = 'https://www.crazygames.com/game/memory-match';
        break;
    }
    
    document.getElementById('gameFrame').src = url;
    // Start timer
    this.gameTimeLeft = 300;
    this.updateTimer();
    this.gameTimer = setInterval(() => this.updateTimer(), 1000);
  },
  
  updateTimer() {
    this.gameTimeLeft--;
    const minutes = Math.floor(this.gameTimeLeft / 60);
    const seconds = this.gameTimeLeft % 60;
    document.getElementById('gameTimer').textContent = 
      `Time remaining: ${minutes}:${seconds.toString().padStart(2, '0')}`;
    
      `Time: ${minutes}:${seconds.toString().padStart(2, '0')}`;
    if (this.gameTimeLeft <= 0) {
      this.closeGame();
      alert("Time's up! Great job! Come back and play again!");
    }
  },
  
  closeGame() {
    clearInterval(this.gameTimer);
    document.getElementById('gameModal').classList.remove('active');
    document.getElementById('gameFrame').src = '';
  },
  async loadBehaviors() {
    const snapshot = await db.collection('behaviors')
      .where('studentId', '==', this.currentStudent.id)
      .orderBy('timestamp', 'desc')
      .limit(10)
      .get();
    const feed = document.getElementById('behaviorFeed');
    feed.innerHTML = '';
    if (snapshot.empty) {
      feed.innerHTML = '<p>No behaviors yet. Be your best self!</p>';
      return;
    }
    snapshot.forEach(doc => {
      const b = doc.data();
      const date = new Date(b.timestamp).toLocaleDateString();
      const points = b.type === 'positive' ? '+10' : '-5';
      feed.innerHTML += `
        <div class="behavior-item">
          <span>${b.type === 'positive' ? '‚≠ê' : 'üìù'} ${b.behavior}</span>
          <span class="${b.type === 'positive' ? 'positive' : 'negative'}">${points}</span>
        </div>
      `;
    });
  }
};

// Initialize
// Start
document.addEventListener('DOMContentLoaded', () => Arcade.init());
</script>
</body>
